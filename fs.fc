options( bank:-1 );

use mmc3;
use * from fs_config;
use mem;
use common;

const BASE = 0xa000;
const BANK_SIZE = 0x2000;

function copy( to:int*, idx:int16 ):int
{
	var offset = _FS_ADDR[idx];
	var bank:int = offset / BANK_SIZE;
	var addr = <int*>(BASE+(offset & (BANK_SIZE-1)));
	var size = _FS_SIZE[idx];
	
	var old_bank = mmc3.set_pbank(1,4+bank);
	mem.copy( to, addr, size );
	mmc3.set_pbank(1,old_bank);
	
	return size;
}

